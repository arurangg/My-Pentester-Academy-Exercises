#!/usr/bin/env python
#scapy library does not work on localhost
import sys
from scapy.all import TCP,IP,sr

if len(sys.argv) < 2:
    print sys.argv[0] + " <target>"
    sys.exit(1)
#Send syn packets to target's ports (firsts 1000) and process only received packets with syn/ack flags
ans,_ = sr( IP(dst=sys.argv[1])/TCP(dport=range(1,1001), flags=2), verbose = False, timeout=.2)
for s,r in ans:
        if r[TCP].flags == 18:
                print "%d open"%s.dport
